<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Cyber Gate Login</title>
  <link href="https://fonts.googleapis.com/css2?family=Helvetica:wght@400;700&display=swap" rel="stylesheet" />
  <style>
    body {
      font-family: 'Helvetica', Arial, sans-serif;
      padding: 20px;
      background: linear-gradient(135deg, #3e3e3e, #66bb6a); /* Gray to green gradient */
      color: #fff;
      display: flex;
      justify-content: center;
      align-items: center;
      min-height: 100vh;
      margin: 0;
    }

    #loginForm,
    #dashboard {
      width: 100%;
      max-width: 450px;
      background: rgba(255, 255, 255, 0.9);
      padding: 40px;
      border-radius: 25px;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
      display: flex;
      flex-direction: column;
      gap: 20px;
      align-items: center;
    }

    h2 {
      margin-bottom: 10px;
      color: #333;
      text-align: center;
      font-size: 24px;
      font-weight: 700;
    }

    .sub {
      font-size: 1.1em;
      color: #555;
      text-align: center;
      margin-bottom: 20px;
      font-weight: 500;
    }

    input {
      width: 100%;
      padding: 14px;
      margin-bottom: 20px;
      border: none;
      border-radius: 25px;
      font-size: 1.1em;
      background: #f1f1f1;
      color: #333;
      transition: background 0.3s, box-shadow 0.3s;
      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
    }

    input::placeholder {
      color: #aaa;
    }

    input:focus {
      background: #fff;
      box-shadow: 0 0 8px #66bb6a;
      outline: none;
    }

    button {
      width: 100%;
      padding: 14px;
      background: #66bb6a;
      color: #fff;
      font-size: 1.1em;
      border: none;
      border-radius: 25px;
      cursor: pointer;
      font-weight: 700;
      transition: background 0.3s, color 0.3s;
      margin-bottom: 10px;
    }

    button:hover {
      background: #4caf50;
    }

    button:active {
      background: #388e3c;
    }

    button:nth-child(2) {
      background: #ff9800;
    }

    button:nth-child(2):hover {
      background: #fb8c00;
    }

    button:nth-child(2):active {
      background: #e65100;
    }

    .error {
      color: #ff5555;
      font-size: 0.9em;
      text-align: center;
      margin-top: 10px;
      font-weight: 600;
    }

    iframe {
      width: 100%;
      height: 300px;
      border-radius: 25px;
      margin-top: 20px;
      background: #000;
    }

    .loading {
      color: #ff7e5f;
      font-weight: 700;
      text-align: center;
    }
  </style>
</head>
<body>

  <div id="loginForm">
    <h2>CYBER GATE</h2>
    <p class="sub">Enter the IP address to connect.</p>

    <input type="text" id="ip" placeholder="Enter IP Address (e.g. 192.168.1.200)" />

    <button onclick="connect()">Connect</button>
    <button onclick="configure()">Configure</button>
    <p class="error" id="errorMsg"></p>
  </div>

  <div id="dashboard" style="display: none;">
    <h2>GATE DASHBOARD</h2>
    <button onclick="logout()">Disconnect</button>
    <div id="loadingMsg" class="loading" style="display: none;">Loading...</div>
    <iframe id="espFrame" src="" onload="iframeLoaded()"></iframe>
  </div>

  <script>
    // Function to save the IP to localStorage
    function saveToLocalStorage() {
      const ip = document.getElementById('ip').value.trim();
      localStorage.setItem('ip', ip);
    }

    // Function to load the IP from localStorage and pre-fill the form
    function loadFromLocalStorage() {
      const ip = localStorage.getItem('ip') || "";
      document.getElementById('ip').value = ip;
    }

    function connect() {
      const ip = document.getElementById('ip').value.trim();
      const errorMsg = document.getElementById('errorMsg');
      const loadingMsg = document.getElementById('loadingMsg');

      errorMsg.textContent = "";
      loadingMsg.style.display = 'block';

      if (!ip) {
        errorMsg.textContent = "GATE IP address is required.";
        loadingMsg.style.display = 'none';
        return;
      }

      if (!isValidIP(ip)) {
        errorMsg.textContent = "Invalid IP address format.";
        loadingMsg.style.display = 'none';
        return;
      }

      // Save the IP address to localStorage
      saveToLocalStorage();

      // Open the URL in the iframe
      document.getElementById('loginForm').style.display = 'none';
      document.getElementById('dashboard').style.display = 'block';
      document.getElementById('espFrame').src = `http://${ip}`;
    }

    function configure() {
      const ip = document.getElementById('ip').value.trim();
      if (ip) {
        window.open(`http://${ip}`, '_blank');
      } else {
        document.getElementById('errorMsg').textContent = "Please enter a valid IP address.";
      }
    }

    function logout() {
      document.getElementById('dashboard').style.display = 'none';
      document.getElementById('loginForm').style.display = 'block';
      document.getElementById('espFrame').src = '';
    }

    function iframeLoaded() {
      const loadingMsg = document.getElementById('loadingMsg');
      loadingMsg.style.display = 'none';
    }

    // Validate IP format
    function isValidIP(ip) {
      return /^(25[0-5]|2[0-4]\d|[01]?\d\d?)\.(25[0-5]|2[0-4]\d|[01]?\d\d?)\.(25[0-5]|2[0-4]\d|[01]?\d\d?)\.(25[0-5]|2[0-4]\d|[01]?\d\d?)$/.test(ip);
    }

    // Load data from localStorage when the page loads
    window.onload = function () {
      loadFromLocalStorage();
      document.getElementById('loginForm').style.display = 'block';
      document.getElementById('dashboard').style.display = 'none';
    };
  </script>

</body>
</html>
